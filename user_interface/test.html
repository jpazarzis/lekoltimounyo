<!DOCTYPE html>
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<link rel="stylesheet" href="basic_theme.css" />
<script>

    var server_name = "localhost";

    function mycallback(data)
    {
        var $schools_div = $("#display_schools");
        $schools_div.empty();
        for(var i = 0; i < data.length; ++i)
        {
            var div = '<div class="school_detail">';
            div += '<a href="">' + data[i].name + '</a></br>';
            div += 'Grouping: ' + '<b>' +data[i].grouping + '</b><br>';
            div += 'Address: ' + '<b>' + data[i].address + '</b><br>';
            div += 'Department: ' + '<b>' +data[i].department + '</b><br>';
            div += 'Community: ' + '<b>' +data[i].community + '</b><br>';
            div += 'City: ' + '<b>' +data[i].city + '</b><br>';
            div += 'Telephone: ' + '<b>' +data[i].telephone + '</b><br>';
            div += '</div>';
            $schools_div.append(div);
        }
    }

    function school_data_callback(data)
    {
        /* 
        we have received the detailed data for a specific school in
        the form of a json document, where the key represents the field
        name while the value its field value. 

        Now let's go ahead and present this data to the user by creating
        an HTML table consisting of two columns (key - value)
        */

        $('#school_data').html('');
        var table = document.createElement("table");

        var x = '';
        $.each(data, function(field_name, field_value) {

            var row = document.createElement("tr");

            var field_name_cell = document.createElement("td");
            field_name_cell.appendChild(document.createTextNode(field_name));

            var field_value_cell = document.createElement("td");
            field_value_cell.appendChild(document.createTextNode(field_value));

            row.appendChild(field_name_cell);
            row.appendChild(field_value_cell);

            table.appendChild(row);
        });

        $('#school_data').append(table);
    }

    function load_school_data(school_id)
    {
        var url = 'http://' + server_name + ':5002/school/'+ school_id +'?callback=?';
        $.getJSON(url, null, school_data_callback);
    }

    function get_matching_schools()
    {
        var v = $("#school_name").val();
        if(v.length > 0)
        {
            var url = 'http://' + server_name + ':5002/matches/'+ v +'?callback=?'
            $.getJSON(url, null, mycallback);
        }
    }
</script>
</head>   
<body>
    <div id='find_school'>
        <h2>Find a School</h2>
        <div class='radio_options'>
        <input type="radio" name="find_schools" value="find_schools_by_name" checked="checked"/>by name</input>
        <input type="radio" name="find_schools" value="find_schools_by_location"/>by location</input>
        </div>

        <div>
            <input type="text" id="school_name" onkeyup='get_matching_schools()'>
        </div>

        <div id='display_schools'>
        </div>
    </div>
</body>
</html>
